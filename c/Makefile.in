# @configure_input@

CFLAGS += @CFLAGS@
CC=@CC@
#AR=@AR@
AR=ar
RANLIB=@RANLIB@

# autoconf: 
# @EXEEXT@ - executable file extension


# Package-related substitution variables

package        = @PACKAGE_NAME@
version        = @PACKAGE_VERSION@
tarname        = @PACKAGE_TARNAME@
distdir        = $(tarname)-$(version)
prefix         = @prefix@

LIB=libmqttudp.a

goal:: all run

all:: mqtt_udp_pub mqtt_udp_sub mqtt_udp_listen

run::
	./mqtt_udp_sub

clean::
	-rm *.o *.exe

OBJS=udp_send_pkt.o udp_recv_pkt.o mqtt_udp.o mqtt_udp_parse.o mqtt_udp_build.o mqtt_udp_send.o mqtt_udp_recv.o  mqtt_udp_util.o


library:: libmqttudp.a

$(LIB): $(OBJS)
	$(AR) rc $@ $(OBJS)
	$(RANLIB) $@
	cp $@ libmqttudp.@PACKAGE_VERSION@.a

#mqtt_udp_pub: $(OBJS) mqtt_udp_pub.o
mqtt_udp_pub: mqtt_udp_pub.o $(LIB)
	$(CC) $(CFLAGS) -o $@ $^

#mqtt_udp_sub: $(OBJS) mqtt_udp_sub.o
mqtt_udp_sub: mqtt_udp_sub.o $(LIB)
	$(CC) $(CFLAGS) -o $@ $^

#mqtt_udp_listen: $(OBJS) mqtt_udp_listen.o
mqtt_udp_listen: mqtt_udp_listen.o $(LIB)
	$(CC) $(CFLAGS) -o $@ $^
